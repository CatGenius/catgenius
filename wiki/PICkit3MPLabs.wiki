#summary Hacking the Hack: How to customize the CatGenius source code

= Introduction =

<b>NOTE: This is a work in progress.  Need to add information about how to set up the HI-TECH C compiler</b>

This page outlines how to make modifications to the CatGenius and associated source code, and flash those modifications to your CatGenie.

= Preparation =

Perform these steps from the [HowToProgram Programming] page:
  * Install the MPLab software
  * Create the programming cable

= Opening the Project in the MPLab IDE =

After everything is downloaded/installed, use Windows Explorer to browse to the folder where the CatGenius software is located, then double-click on the appropriate project file based on the PIC processor in your unit (catgenius_16f877a.mcp or catgenius_16f1939.mcp).  The MPLab IDE will open and load the project.

If you're running 32-bit Windows, you'll need to locate the missing picXXX.h include file for your microcontroller.  Right-click on the missing file and browse to {{{C:\Program Files\HI-TECH Software\PICC\9.83\include}}} to locate it:
http://catgenius.googlecode.com/svn/wiki/images/apresence/mplab_missing_file_1.png
http://catgenius.googlecode.com/svn/wiki/images/apresence/mplab_missing_file_2.png

= Hacking the code =

Make whatever modifications you'd like.  Do so at your own risk

Now compile the code:<br>
{{{Project / Build}}}

= Flashing the firmware =

In my experience, the PICkit 3 has never flashed properly unless the CatGenie is plugged in.  If you haven't plugged your CatGenie in, do so now.

Connect your PICkit 3 to the CatGenie board using the programming cable, connect your PICkit 3 to the computer with the provided USB cable, then select the PICkit 3 as your programmer:<br>
http://catgenius.googlecode.com/svn/wiki/images/apresence/mplab_programmer_select_pickit3.png

You'll get a warning about device detection.  Some devices have lower voltage tolerances, so if you don't have the right device detected, you can fry your microcontroller.  Double-check that you opened the correct project for your microcontroller, then click OK:<br>
http://catgenius.googlecode.com/svn/wiki/images/apresence/mplab_voltage_caution.png

MPLab will connect to the PICkit 3 and verify connectivity of the CatGenie microcontroller:<br>
http://catgenius.googlecode.com/svn/wiki/images/apresence/mplab_pickit3_target_connected.png

You are now ready to flash the new firmware!<br>
Select {{{Programmer / Program}}}.  MPLab will write the firmware and verify it in one pass:<br>
http://catgenius.googlecode.com/svn/wiki/images/apresence/mplab_programmer_pickit3_program.png

If you got errors, double-check your cable and connections to make sure everything is wired correctly and tightly connected.